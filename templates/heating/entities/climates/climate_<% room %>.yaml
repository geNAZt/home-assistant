platform: climate_template
name: Climate room [[ room ]]
unique_id: climate_room_[[ room ]]
modes:
- "auto"
- "heat"
- "off"
min_temp: 12
max_temp: 40
temp_step: 0.1
precision: 0.1
current_temperature_template: "{{ states('sensor.temperature_[[ room ]]_mean') }}"
availability_template: "{{ is_state('input_boolean.heating_available_[[ room ]]', 'on') }}"
target_temperature_template: "{{ states('input_number.heating_base_[[ room ]]') }}"
set_temperature:
  - action: input_number.set_value
    target:
      entity_id: input_number.heating_base_[[ room ]]
    data:
      value: "{{ state_attr('input_number.heating_base_[[ room ]]', 'temperature') | float }}"
set_hvac_mode:
  - choose:
    - conditions:
      - condition: template
        value_template: "{{ states('climate.climate_room_[[ room ]]') == 'off' }}"
      sequence:
        - action: switch.turn_off
          target:
            entity_id: switch.heating_[[ room ]]
    - conditions:
      - condition: template
        value_template: "{{ states('climate.climate_room_[[ room ]]') == 'heat' }}"
      sequence:
        - action: switch.turn_on
          target:
            entity_id: switch.heating_[[ room ]]