light:
- name: "Licht [[room]] (virtuell)"
  unique_id: room_[[room]]
  # state: on/off anhand des Auto-Boolean
  state: >-
    {% if is_state('input_boolean.auto_light_[[room]]', 'on') %}
      on
    {% else %}
      off
    {% endif %}
  # Helligkeit vom Helper holen
  level: "{{ states('input_number.[[room]]_brightness') | int(0) }}"
  # Farbtemperatur vom Helper holen
  # Achtung: Home Assistant erwartet hier mired, nicht Kelvin
  # Passe deinen Helper-Bereich ggf. an (z.B. 153â€“500)
  temperature: "{{ states('input_number.[[room]]_color_temp') | int(213) }}"
  # Einschalten der "Automatik"
  turn_on:
    - action: input_boolean.turn_on
      target:
        entity_id: input_boolean.auto_light_[[room]]
  # Ausschalten: Automatik OFF + echte Lampen aus
  turn_off:
    - action: input_boolean.turn_off
      target:
        entity_id: input_boolean.auto_light_[[room]]
    - action: light.turn_off
      target:
        entity_id: light.[[room]]_lights
  # Slider -> Helligkeits-Helper schreiben
  set_level:
    - action: input_number.set_value
      target:
        entity_id: input_number.[[room]]_brightness
      data:
        value: "{{ brightness }}"
  # Farbtemperatur-Slider -> Helper schreiben
  set_temperature:
    - action: input_number.set_value
      target:
        entity_id: input_number.[[room]]_color_temp
      data:
        value: "{{ color_temp }}"